---
title: 基本语法
date: 2021-04-25 08:55:27
permalink: /pages/ea3820/
categories:
  - 后端
  - PHP
tags:
  - 
---

## 基本语法

### PHP标记分离

```php
<?php $expression = true; if ($expression == true): ?>
    第一部分
<?php else: ?>
    第二部分
<?php endif; ?>
```

这里会显示第一部分

在一个 PHP 代码段中的最后一行可以不用分号结束。如果后面还有新行，则代码段的结束标记包含了行结束。

```php
<?php echo "Some text"; ?>
    No newline
<?= "But newline now" ?>
```

### 注释

注释支持单行和多行注释

```php
<?php
echo 'This is a test'; // This is a one-line c++ style comment
/* This is a multi line comment
   yet another line of comment */
echo 'This is yet another test';
echo 'One Final Test'; # This is a one-line shell-style comment
?>
```

## 类型

PHP支持10种原始数据类型

四种标量类型：

- bool（布尔型）
- int（整型）
- float（浮点型，也称作 double)
- string（字符串）

四种复合类型：

- array（数组）
- object（对象）
- [callable](https://www.php.net/manual/zh/language.types.callable.php)（可调用）
- [iterable](https://www.php.net/manual/zh/language.types.iterable.php)（可迭代）

最后是两种特殊类型：

- resource（资源）
- NULL（无类型）

```php
<?php
$a_bool = TRUE;   // 布尔值 boolean
$a_str  = "foo";  // 字符串 string
$a_str2 = 'foo';  // 字符串 string
$an_int = 12;     // 整型 integer

echo gettype($a_bool); // 输出:  boolean
echo gettype($a_str);  // 输出:  string

// 如果是整型，就加上 4
if (is_int($an_int)) {
    $an_int += 4;
}

// 如果 $bool 是字符串，就打印出来
// (啥也没打印出来)
if (is_string($a_bool)) {
    echo "String: $a_bool";
}
// 输出booleanstring
```

### bool类型

我们可以进行强制类型转换

```php
<?php
var_dump((bool) "");        // bool(false)
var_dump((bool) 1);         // bool(true)
var_dump((bool) -2);        // bool(true)
var_dump((bool) "foo");     // bool(true)
var_dump((bool) 2.3e5);     // bool(true)
var_dump((bool) array(12)); // bool(true)
var_dump((bool) array());   // bool(false)
var_dump((bool) "false");   // bool(true)
```

### 整数类型

```php
<?php
$a = 1234; // 十进制数
$a = 0123; // 八进制数 (等于十进制 83)
$a = 0x1A; // 十六进制数 (等于十进制 26)
$a = 0b11111111; // 二进制数字 (等于十进制 255)
$a = 1_234_567; // 整型数值 (PHP 7.4.0 以后)
```

### 浮点型

```php
<?php
$a = 1.234; 
$b = 1.2e3; 
$c = 7E-10;
$d = 1_234.567; // 从 PHP 7.4.0 开始支持
```

### 字符串类型

单引号输出的内容需要进行转义，且不会输出变量

```php
<?php
echo 'this is a simple string';

// 可以录入多行
echo 'You can also have embedded newlines in 
strings this way as it is
okay to do';

// 输出： Arnold once said: "I'll be back"
echo 'Arnold once said: "I\'ll be back"';

// 输出： You deleted C:\*.*?
echo 'You deleted C:\\*.*?';

// 输出： You deleted C:\*.*?
echo 'You deleted C:\*.*?';

// 输出： This will not expand: \n a newline
echo 'This will not expand: \n a newline';

// 输出： Variables do not $expand $either
echo 'Variables do not $expand $either';
```

双引号可以输出变量

```php
<?php
$a = 666;
// 输出测试666
echo "测试$a";
```

双引号会对下面的特殊符号进行转义

| 序列                 | 含义                                                         |
| :------------------- | :----------------------------------------------------------- |
| `\n`                 | 换行（ASCII 字符集中的 LF 或 0x0A (10)）                     |
| `\r`                 | 回车（ASCII 字符集中的 CR 或 0x0D (13)）                     |
| `\t`                 | 水平制表符（ASCII 字符集中的 HT 或 0x09 (9)）                |
| `\v`                 | 垂直制表符（ASCII 字符集中的 VT 或 0x0B (11)）（自 PHP 5.2.5 起） |
| `\e`                 | Escape（ASCII 字符集中的 ESC 或 0x1B (27)）（自 PHP 5.4.0 起） |
| `\f`                 | 换页（ASCII 字符集中的 FF 或 0x0C (12)）（自 PHP 5.2.5 起）  |
| `\\`                 | 反斜线                                                       |
| `\$`                 | 美元标记                                                     |
| `\"`                 | 双引号                                                       |
| `\[0-7]{1,3}`        | 符合该正则表达式序列的是一个以八进制方式来表达的字符         |
| `\x[0-9A-Fa-f]{1,2}` | 符合该正则表达式序列的是一个以十六进制方式来表达的字符       |

一些复杂的语法

使用 `{}` 来存放表达式

```php
<?php
$great = 'fantastic';

// 无效，输出: This is { fantastic}
echo "This is { $great}"."<br>";

// 有效，输出： This is fantastic
echo "This is {$great}"."<br>";
echo "This is ${great}"."<br>";
```

输出

This is { fantastic}
This is fantastic
This is fantastic

还可以使用变量来访问对象

```php
<?php
class foo {
    var $bar = 'I am bar.';
}

$foo = new foo();
$bar = 'bar';
$baz = array('foo', 'bar', 'baz', 'quux');
echo "{$foo->$bar}\n";
echo "{$foo->{$baz[1]}}\n";
```

输出 

I am bar.
I am bar.

可以获取类中的静态变量

```php
<?php
// 显示所有错误
error_reporting(E_ALL);

class beers {
    const softdrink = 'rootbeer';
    public static $ale = 'ipa';
}

$rootbeer = 'A & W';
$ipa = 'Alexander Keith\'s';

// 有效，输出： I'd like an A & W
echo "I'd like an {${beers::softdrink}}\n";

// 也有效，输出： I'd like an Alexander Keith's
echo "I'd like an {${beers::$ale}}\n";
```

当然我们也可以像操作数组一样对字符串进行修改

```php
<?php
// 取得字符串的第一个字符
$str = 'This is a test.';
$first = $str[0];

// 取得字符串的第三个字符
$third = $str[2];

// 取得字符串的最后一个字符
$str = 'This is still a test.';
$last = $str[strlen($str)-1];

// 修改字符串的最后一个字符
$str = 'Look at the sea';
$str[strlen($str)-1] = 'e';
```

字符串可以直接转换为字符

```php
<?php
$foo = 1 + "10.5";                // $foo is float (11.5)
$foo = 1 + "-1.3e3";              // $foo is float (-1299)
$foo = 1 + "bob-1.3e3";           // $foo is integer (1)
$foo = 1 + "bob3";                // $foo is integer (1)
$foo = 1 + "10 Small Pigs";       // $foo is integer (11)
$foo = 4 + "10.2 Little Piggies"; // $foo is float (14.2)
$foo = "10.0 pigs " + 1;          // $foo is float (11)
$foo = "10.0 pigs " + 1.0;        // $foo is float (11)     
```

### Array数组

PHP 中的数组实际上是一个有序映射。映射是一种把 *values* 关联到 *keys* 的类型。此类型在很多方面做了优化，因此可以把它当成真正的数组，或列表（向量），散列表（是映射的一种实现），字典，集合，栈，队列以及更多可能性。由于数组元素的值也可以是另一个数组，树形结构和多维数组也是允许的。

可以当成map使用

```php
<?php
$array = [
    "foo" => "bar",
    "bar" => "foo",
];

echo $array["foo"].$array["bar"];
```

输出 barfool

也可以当成数组

```php
<?php
$array = ["666",45];

echo $array[0]."|".$array[1];
```

输出 666|45

打印数组，我们可以使用var_dump函数

```php
<?php
$array = ["666",45];

var_dump($array);
```

输出：

array(2) { [0]=> string(3) "666" [1]=> int(45) }

遍历数组

```php
<?php
$colors = array('red', 'blue', 'green', 'yellow');

foreach ($colors as $color) {
    echo "Do you like $color?\n";
}
```

```
Do you like red?
Do you like blue?
Do you like green?
Do you like yellow?
```

删除数组中某一个元素

```php
<?php
$array = ["666",45];
var_dump($array);
unset($array[0]);
var_dump($array);
```

更多参考

[PHP: Array 数组 - Manual](https://www.php.net/manual/zh/language.types.array.php)

### Iterable 可迭代对象

[Iterable](https://www.php.net/manual/zh/language.types.iterable.php)是 PHP 7.1 中引入的一个伪类型。它接受任何 array 或实现了 **Traversable** 接口的对象。这些类型都能用 [foreach](https://www.php.net/manual/zh/control-structures.foreach.php) 迭代， 也可以和 [生成器](https://www.php.net/manual/zh/language.generators.php) 里的 **yield from** 一起使用。

这个东西可以作为参数

```php
<?php
function foo(iterable $iterable) {
    foreach ($iterable as $value) {
        // ...
    }
}
```

也可以作为返回类型

```php
<?php
function bar(): iterable {
    return [1, 2, 3];
}
```

### object对象

我们可以使用new来进行object对象初始化

```php
<?php
class foo
{
    function do_foo()
    {
        echo "Doing foo."; 
    }
}
$bar = new foo;
$bar->do_foo();
```

也可以转换为对象

如果将一个对象转换成对象，它将不会有任何变化。如果其它任何类型的值被转换成对象，将会创建一个内置类 `stdClass` 的实例。如果该值为 **`null`**，则新的实例为空。 array 转换成 object 将使键名成为属性名并具有相对应的值。注意：在这个例子里， 使用 PHP 7.2.0 之前的版本，数字键只能通过迭代访问。

```php
<?php
$obj = (object) array('1' => 'foo');
var_dump(isset($obj->{'1'})); // PHP 7.2.0 后输出 'bool(true)'，之前版本会输出 'bool(false)' 
var_dump(key($obj)); // PHP 7.2.0 后输出 'string(1) "1"'，之前版本输出  'int(1)' 
```

### NULL

特殊的 **`null`** 值表示一个变量没有值。NULL 类型唯一可能的值就是 **`null`**。

在下列情况下一个变量被认为是 **`null`**：

- 被赋值为 **`null`**。
- 尚未被赋值。
- 被 [unset()](https://www.php.net/manual/zh/function.unset.php)。

### Callback和callable类型

```php
<?php
// 自己定义的函数
function my_callback_function() {
    echo 'hello world!';
}
// 我们可以直接调用函数
call_user_func('my_callback_function');

// 这里我们创建一个对象
class MyClass {
    static function myCallbackMethod() {
        echo 'Hello World!';
    }
}
// 我们调用对象里的方法
call_user_func(array('MyClass', 'myCallbackMethod'));
// 当然我们可以也可以初始化对象然后调用
$obj = new MyClass();
call_user_func(array($obj, 'myCallbackMethod'));
// 也可以这样用
call_user_func('MyClass::myCallbackMethod');
```

## 变量

变量名与 PHP 中其它的标签一样遵循相同的规则。一个有效的变量名由字母或者下划线开头，后面跟上任意数量的字母，数字，或者下划线。

### 预定义变量

PHP 提供了大量的预定义变量。由于许多变量依赖于运行的服务器的版本和设置，及其它因素，所以并没有详细的说明文档。一些预定义变量在 PHP 以[命令行](https://www.php.net/manual/zh/features.commandline.php)形式运行时并不生效。 详细参阅[预定义变量](https://www.php.net/manual/zh/reserved.variables.php)一章。

### 变量的范围

默认情况下范围会有一个单独的范围，这里包括了include和require引入的文件

```php
<?php
$a = 1;
include 'b.inc';
```

但是下面这种情况就会报错，因为函数里面的$a并没有赋值

```php
<?php
$a = 1; /* global scope */
function Test()
{
    echo $a; /* reference to local scope variable */
}
Test();
```

所以我们需要使用global关键词来使用变量

```php
<?php
$a = 1;
$b = 2;
function Sum()
{
    global $a, $b;
    $b = $a + $b;
}
Sum();
echo $b;
// 输出3
```

当然我们也可以使用global数组

```php
<?php
$a = 1;
$b = 2;
function Sum()
{
    $GLOBALS['b'] = $GLOBALS['a'] + $GLOBALS['b'];
}
Sum();
echo $b;
```

还有一个静态变量

```php
<?php
function test()
{
    static $a = 0;
    echo $a." ";
    $a++;
}
for ($i=0;$i<5;$i++){
    test();
}
// 输出0 1 2 3 4
```

如果不加static，那么每次输出的都是一样的

