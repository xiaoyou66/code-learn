原文

[Go 开发关键技术指南 | Go 面向失败编程 (内含超全知识大图）-阿里云开发者社区 (aliyun.com)](https://developer.aliyun.com/article/740696)

### 哪些可以 Recover

Go 有 [Defer, Panic, and Recover](https://blog.golang.org/defer-panic-and-recover)。其中 defer 一般用在资源释放或者捕获 panic。而 panic 是中止正常的执行流程，执行所有的 defer，返回调用函数继续 panic；主动调用 panic 函数，还有些运行时错误都会进入 panic 过程。最后 recover 是在 panic 时获取控制权，进入正常的执行逻辑。

注意 recover 只有在 defer 函数中才有用，在 defer 的函数调用的函数中 recover 不起作用，如下实例代码不会 recover：

```go
package main

import "fmt"

func main() {
    f := func() {
        if r := recover(); r != nil {
            fmt.Println(r)
        }
    }
    defer func() {
        f()
    } ()
    panic("ok")
}
```

有些情况是不可以被捕获，程序会自动退出，这种都是无法正常 recover。当然，一般的 panic 都是能捕获的，比如 Slice 越界、nil 指针、除零、写关闭的 chan。

### Recover 最佳实践

